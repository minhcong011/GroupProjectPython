{% extends 'student_page/student_base.html' %}
{% load static %}

{% block title %}K·∫øt qu·∫£ b√†i t·∫≠p{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/quiz_result.css' %}">
{% endblock %}

{% block banner %}
<div class="banner">
  <span>
    <b>K·∫øt qu·∫£: {{ assignment.tieu_de }}</b>
    <span class="course-code">CS466</span>
  </span>
  <span class="right">
    ƒêi·ªÉm: {{ score }}/{{ total_questions }} ({{ percentage|floatformat:1 }}%)
  </span>
</div>
{% endblock %}

{% block content %}
<div class="result-container">
  
  <!-- K·∫øt qu·∫£ t·ªïng quan -->
  <div class="result-summary {% if percentage >= 70 %}excellent{% elif percentage >= 50 %}good{% else %}poor{% endif %}">
    <h2 class="result-title {% if percentage >= 70 %}excellent{% elif percentage >= 50 %}good{% else %}poor{% endif %}">
      K·∫øt qu·∫£ b√†i l√†m
    </h2>
    <div class="result-score {% if percentage >= 70 %}excellent{% elif percentage >= 50 %}good{% else %}poor{% endif %}">
      {{ score }}/{{ total_questions }} c√¢u ƒë√∫ng ({{ percentage|floatformat:1 }}%)
    </div>
    <p class="result-message">
      {% if percentage >= 70 %}
        üéâ Ch√∫c m·ª´ng! B·∫°n ƒë√£ l√†m b√†i r·∫•t t·ªët!
      {% elif percentage >= 50 %}
        üëç K·∫øt qu·∫£ kh√° t·ªët, h√£y c·ªë g·∫Øng h∆°n l·∫ßn sau!
      {% else %}
        üí™ H√£y √¥n t·∫≠p th√™m v√† c·ªë g·∫Øng h∆°n nh√©!
      {% endif %}
    </p>
  </div>

  <!-- Chi ti·∫øt t·ª´ng c√¢u h·ªèi -->
  <h3 class="details-title">Chi ti·∫øt k·∫øt qu·∫£:</h3>
  
  {% for result in results %}
  <div class="question-result {% if result.is_correct %}correct{% else %}incorrect{% endif %}">
    <div class="question-header">
      <span class="question-number {% if result.is_correct %}correct{% else %}incorrect{% endif %}">
        C√¢u {{ forloop.counter }}
      </span>
      <span class="question-status {% if result.is_correct %}correct{% else %}incorrect{% endif %}">
        {% if result.is_correct %}‚úì ƒê√∫ng{% else %}‚úó Sai{% endif %}
      </span>
    </div>
    
    <p class="question-text">{{ result.question.noi_dung }}</p>
    
    <div class="answer-section">
      <p>
        <strong>B·∫°n ch·ªçn:</strong> 
        <span class="user-answer {% if result.is_correct %}correct{% else %}incorrect{% endif %}">
          {% if result.user_answer %}
            {{ result.user_answer }}) 
            {% if result.user_answer == 'A' %}{{ result.question.lua_chon_a }}
            {% elif result.user_answer == 'B' %}{{ result.question.lua_chon_b }}
            {% elif result.user_answer == 'C' %}{{ result.question.lua_chon_c }}
            {% elif result.user_answer == 'D' %}{{ result.question.lua_chon_d }}
            {% endif %}
          {% else %}
            Kh√¥ng ch·ªçn ƒë√°p √°n
          {% endif %}
        </span>
      </p>
      
      {% if not result.is_correct %}
      <p>
        <strong>ƒê√°p √°n ƒë√∫ng:</strong> 
        <span class="correct-answer">
          {{ result.correct_answer }}) 
          {% if result.correct_answer == 'A' %}{{ result.question.lua_chon_a }}
          {% elif result.correct_answer == 'B' %}{{ result.question.lua_chon_b }}
          {% elif result.correct_answer == 'C' %}{{ result.question.lua_chon_c }}
          {% elif result.correct_answer == 'D' %}{{ result.question.lua_chon_d }}
          {% endif %}
        </span>
      </p>
      {% endif %}
    </div>
  </div>
  {% endfor %}

  <div class="result-actions">
    <a href="{% url 'studentapp:assignment_list' %}" class="back-to-list">
      Quay l·∫°i danh s√°ch b√†i t·∫≠p
    </a>
  </div>
</div>
{% endblock %}
